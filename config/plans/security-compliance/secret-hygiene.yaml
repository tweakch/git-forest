id: secret-hygiene
name: Secret Hygiene
version: 1.0.0
category: security-compliance
description: |
  Remove hardcoded secrets and rotate keys.
  This plan identifies hardcoded secrets, credentials, and API keys in code and
  configuration, proposes secure storage alternatives, and ensures regular key rotation.

focus_areas:
  - Detect hardcoded secrets in code
  - Scan for exposed credentials in config files
  - Identify API keys and tokens
  - Move secrets to secure storage (Key Vault, Secrets Manager)
  - Implement secret rotation policies
  - Audit secret access patterns

scopes:
  - security
  - compliance
  - credentials

planners:
  - secret-scanner
  - credential-detector
  - key-rotation-planner

planters:
  - secret-remover
  - vault-migrator

policies:
  execution_mode: propose
  risk_level: critical
  max_concurrent_plants: 10
  require_review: true
  require_immediate_action: true

metrics:
  - name: hardcoded_secrets
    description: Number of hardcoded secrets detected
    target: 0
  - name: exposed_credentials
    description: Number of exposed credentials in config
    target: 0
  - name: unrotated_keys
    description: Number of keys not rotated in 90+ days
    target: 0
  - name: secrets_without_vault
    description: Number of secrets not in secure storage
    target: 0

plant_templates:
  - name: remove-hardcoded-secret
    title_template: "Remove hardcoded secret: {secret_type} in {file_path}"
    priority: critical
  - name: migrate-to-vault
    title_template: "Migrate {secret_name} to secure vault"
    priority: critical
  - name: rotate-key
    title_template: "Rotate {key_type} key for {service_name}"
    priority: high
  - name: implement-rotation-policy
    title_template: "Implement rotation policy for {secret_category}"
    priority: high
  - name: audit-secret-access
    title_template: "Audit secret access for {component_name}"
    priority: medium
